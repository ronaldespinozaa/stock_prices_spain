2025-04-25 16:15:25,290 - __main__ - INFO - Iniciando ETL completo (20250425_161525)
2025-04-25 16:15:25,290 - __main__ - INFO - Iniciando fase de EXTRACCIÓN
2025-04-25 16:15:25,291 - __main__ - INFO - Procesando 10 símbolos: ['SAN.MC', 'BBVA.MC', 'IBE.MC', 'ITX.MC', 'TEF.MC', 'REP.MC', 'CABK.MC', 'NTGY.MC', 'FER.MC', 'AMS.MC']
2025-04-25 16:15:25,292 - src.etl.extraction.historical_extraction - INFO - Inicializado extractor para 10 tickers, max_workers=2, period=5y
2025-04-25 16:15:25,292 - src.etl.extraction.historical_extraction - INFO - Procesando 10 en lotes de 3
2025-04-25 16:15:25,293 - src.etl.extraction.historical_extraction - INFO - Procesando lote 1: ['SAN.MC', 'BBVA.MC', 'IBE.MC']
2025-04-25 16:15:25,294 - src.utils.stock_utils - INFO - Descargando datos para SAN.MC con período 5y e intervalo 1d
2025-04-25 16:15:25,294 - src.utils.stock_utils - INFO - Descargando datos para BBVA.MC con período 5y e intervalo 1d
2025-04-25 16:15:26,840 - src.utils.stock_utils - INFO - Descargados 1281 registros para BBVA.MC
2025-04-25 16:15:26,840 - src.utils.stock_utils - INFO - Guardando datos de BBVA.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\BBVA_MC_historical.csv
2025-04-25 16:15:26,855 - src.utils.stock_utils - INFO - Descargados 1281 registros para SAN.MC
2025-04-25 16:15:26,858 - src.utils.stock_utils - INFO - Guardando datos de SAN.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\SAN_MC_historical.csv
2025-04-25 16:15:26,950 - src.utils.stock_utils - INFO - Descargando datos para IBE.MC con período 5y e intervalo 1d
2025-04-25 16:15:28,849 - src.utils.stock_utils - INFO - Descargados 1281 registros para IBE.MC
2025-04-25 16:15:28,851 - src.utils.stock_utils - INFO - Guardando datos de IBE.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\IBE_MC_historical.csv
2025-04-25 16:15:28,891 - src.etl.extraction.historical_extraction - INFO - Esperando 15 segundos antes del siguiente lote...
2025-04-25 16:15:43,892 - src.etl.extraction.historical_extraction - INFO - Procesando lote 1: ['BBVA.MC', 'IBE.MC', 'ITX.MC']
2025-04-25 16:15:43,892 - src.utils.stock_utils - INFO - Descargando datos para BBVA.MC con período 5y e intervalo 1d
2025-04-25 16:15:43,893 - src.utils.stock_utils - INFO - Descargando datos para IBE.MC con período 5y e intervalo 1d
2025-04-25 16:15:45,478 - src.utils.stock_utils - INFO - Descargados 1281 registros para IBE.MC
2025-04-25 16:15:45,478 - src.utils.stock_utils - INFO - Guardando datos de IBE.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\IBE_MC_historical.csv
2025-04-25 16:15:45,519 - src.utils.stock_utils - INFO - Descargando datos para ITX.MC con período 5y e intervalo 1d
2025-04-25 16:15:45,990 - src.utils.stock_utils - INFO - Descargados 1281 registros para BBVA.MC
2025-04-25 16:15:45,991 - src.utils.stock_utils - INFO - Guardando datos de BBVA.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\BBVA_MC_historical.csv
2025-04-25 16:15:47,507 - src.utils.stock_utils - INFO - Descargados 1281 registros para ITX.MC
2025-04-25 16:15:47,508 - src.utils.stock_utils - INFO - Guardando datos de ITX.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\ITX_MC_historical.csv
2025-04-25 16:15:47,578 - src.etl.extraction.historical_extraction - INFO - Esperando 15 segundos antes del siguiente lote...
2025-04-25 16:16:02,580 - src.etl.extraction.historical_extraction - INFO - Procesando lote 1: ['IBE.MC', 'ITX.MC', 'TEF.MC']
2025-04-25 16:16:02,580 - src.utils.stock_utils - INFO - Descargando datos para IBE.MC con período 5y e intervalo 1d
2025-04-25 16:16:02,580 - src.utils.stock_utils - INFO - Descargando datos para ITX.MC con período 5y e intervalo 1d
2025-04-25 16:16:03,444 - src.utils.stock_utils - INFO - Descargados 1281 registros para IBE.MC
2025-04-25 16:16:03,446 - src.utils.stock_utils - INFO - Guardando datos de IBE.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\IBE_MC_historical.csv
2025-04-25 16:16:03,483 - src.utils.stock_utils - INFO - Descargando datos para TEF.MC con período 5y e intervalo 1d
2025-04-25 16:16:04,624 - src.utils.stock_utils - INFO - Descargados 1281 registros para ITX.MC
2025-04-25 16:16:04,625 - src.utils.stock_utils - INFO - Guardando datos de ITX.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\ITX_MC_historical.csv
2025-04-25 16:16:05,246 - src.utils.stock_utils - INFO - Descargados 1281 registros para TEF.MC
2025-04-25 16:16:05,248 - src.utils.stock_utils - INFO - Guardando datos de TEF.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\TEF_MC_historical.csv
2025-04-25 16:16:05,321 - src.etl.extraction.historical_extraction - INFO - Esperando 15 segundos antes del siguiente lote...
2025-04-25 16:16:20,323 - src.etl.extraction.historical_extraction - INFO - Procesamiento completado: 9/9 símbolos extraídos correctamente
2025-04-25 16:16:20,327 - src.etl.extraction.historical_extraction - INFO - Informe de extracción guardado en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\reports\extraction_report_20250425_161620.csv
2025-04-25 16:16:20,327 - __main__ - INFO - Extracción completada: 9/9 símbolos procesados correctamente
2025-04-25 16:16:20,327 - __main__ - INFO - Informe guardado en: C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\reports\extraction_report_20250425_161620.csv
2025-04-25 16:16:20,327 - __main__ - INFO - Iniciando fase de PROCESAMIENTO
2025-04-25 16:16:20,328 - src.etl.processing.data_processor - INFO - Inicializado procesador de datos con directorio raw: C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw
2025-04-25 16:16:20,329 - src.etl.processing.data_processor - INFO - Encontrados 5 archivos para procesar
2025-04-25 16:16:20,334 - src.etl.processing.data_processor - INFO - Cargados 1278 registros para 2.047654867172241 desde C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\BBVA_MC_historical.csv
2025-04-25 16:16:20,335 - src.etl.processing.data_processor - WARNING - Columna Price no encontrada para 2.047654867172241, creando columna vacía
2025-04-25 16:16:20,336 - src.etl.processing.data_processor - WARNING - Columna Close no encontrada para 2.047654867172241, creando columna vacía
2025-04-25 16:16:20,337 - src.etl.processing.data_processor - WARNING - Columna High no encontrada para 2.047654867172241, creando columna vacía
2025-04-25 16:16:20,337 - src.etl.processing.data_processor - WARNING - Columna Low no encontrada para 2.047654867172241, creando columna vacía
2025-04-25 16:16:20,338 - src.etl.processing.data_processor - WARNING - Columna Open no encontrada para 2.047654867172241, creando columna vacía
2025-04-25 16:16:20,339 - src.etl.processing.data_processor - WARNING - Columna Volume no encontrada para 2.047654867172241, creando columna vacía
2025-04-25 16:16:20,343 - src.etl.processing.data_processor - INFO - Datos procesados para 2.047654867172241: 1278 registros
2025-04-25 16:16:20,366 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\2_047654867172241_processed.csv
2025-04-25 16:16:20,376 - src.etl.processing.data_processor - INFO - Cargados 1278 registros para 7.339988708496094 desde C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\IBE_MC_historical.csv
2025-04-25 16:16:20,377 - src.etl.processing.data_processor - WARNING - Columna Price no encontrada para 7.339988708496094, creando columna vacía
2025-04-25 16:16:20,378 - src.etl.processing.data_processor - WARNING - Columna Close no encontrada para 7.339988708496094, creando columna vacía
2025-04-25 16:16:20,379 - src.etl.processing.data_processor - WARNING - Columna High no encontrada para 7.339988708496094, creando columna vacía
2025-04-25 16:16:20,380 - src.etl.processing.data_processor - WARNING - Columna Low no encontrada para 7.339988708496094, creando columna vacía
2025-04-25 16:16:20,381 - src.etl.processing.data_processor - WARNING - Columna Open no encontrada para 7.339988708496094, creando columna vacía
2025-04-25 16:16:20,381 - src.etl.processing.data_processor - WARNING - Columna Volume no encontrada para 7.339988708496094, creando columna vacía
2025-04-25 16:16:20,390 - src.etl.processing.data_processor - INFO - Datos procesados para 7.339988708496094: 1278 registros
2025-04-25 16:16:20,416 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\7_339988708496094_processed.csv
2025-04-25 16:16:20,421 - src.etl.processing.data_processor - INFO - Cargados 1278 registros para 21.05776596069336 desde C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\ITX_MC_historical.csv
2025-04-25 16:16:20,422 - src.etl.processing.data_processor - WARNING - Columna Price no encontrada para 21.05776596069336, creando columna vacía
2025-04-25 16:16:20,423 - src.etl.processing.data_processor - WARNING - Columna Close no encontrada para 21.05776596069336, creando columna vacía
2025-04-25 16:16:20,423 - src.etl.processing.data_processor - WARNING - Columna High no encontrada para 21.05776596069336, creando columna vacía
2025-04-25 16:16:20,423 - src.etl.processing.data_processor - WARNING - Columna Low no encontrada para 21.05776596069336, creando columna vacía
2025-04-25 16:16:20,424 - src.etl.processing.data_processor - WARNING - Columna Open no encontrada para 21.05776596069336, creando columna vacía
2025-04-25 16:16:20,425 - src.etl.processing.data_processor - WARNING - Columna Volume no encontrada para 21.05776596069336, creando columna vacía
2025-04-25 16:16:20,429 - src.etl.processing.data_processor - INFO - Datos procesados para 21.05776596069336: 1278 registros
2025-04-25 16:16:20,445 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\21_05776596069336_processed.csv
2025-04-25 16:16:20,458 - src.etl.processing.data_processor - INFO - Cargados 1278 registros para 1.6286243200302124 desde C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\SAN_MC_historical.csv
2025-04-25 16:16:20,459 - src.etl.processing.data_processor - WARNING - Columna Price no encontrada para 1.6286243200302124, creando columna vacía
2025-04-25 16:16:20,459 - src.etl.processing.data_processor - WARNING - Columna Close no encontrada para 1.6286243200302124, creando columna vacía
2025-04-25 16:16:20,461 - src.etl.processing.data_processor - WARNING - Columna High no encontrada para 1.6286243200302124, creando columna vacía
2025-04-25 16:16:20,462 - src.etl.processing.data_processor - WARNING - Columna Low no encontrada para 1.6286243200302124, creando columna vacía
2025-04-25 16:16:20,462 - src.etl.processing.data_processor - WARNING - Columna Open no encontrada para 1.6286243200302124, creando columna vacía
2025-04-25 16:16:20,463 - src.etl.processing.data_processor - WARNING - Columna Volume no encontrada para 1.6286243200302124, creando columna vacía
2025-04-25 16:16:20,470 - src.etl.processing.data_processor - INFO - Datos procesados para 1.6286243200302124: 1278 registros
2025-04-25 16:16:20,498 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\1_6286243200302124_processed.csv
2025-04-25 16:16:20,506 - src.etl.processing.data_processor - INFO - Cargados 1278 registros para 2.683774948120117 desde C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\TEF_MC_historical.csv
2025-04-25 16:16:20,506 - src.etl.processing.data_processor - WARNING - Columna Price no encontrada para 2.683774948120117, creando columna vacía
2025-04-25 16:16:20,507 - src.etl.processing.data_processor - WARNING - Columna Close no encontrada para 2.683774948120117, creando columna vacía
2025-04-25 16:16:20,507 - src.etl.processing.data_processor - WARNING - Columna High no encontrada para 2.683774948120117, creando columna vacía
2025-04-25 16:16:20,507 - src.etl.processing.data_processor - WARNING - Columna Low no encontrada para 2.683774948120117, creando columna vacía
2025-04-25 16:16:20,509 - src.etl.processing.data_processor - WARNING - Columna Open no encontrada para 2.683774948120117, creando columna vacía
2025-04-25 16:16:20,510 - src.etl.processing.data_processor - WARNING - Columna Volume no encontrada para 2.683774948120117, creando columna vacía
2025-04-25 16:16:20,514 - src.etl.processing.data_processor - INFO - Datos procesados para 2.683774948120117: 1278 registros
2025-04-25 16:16:20,535 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\2_683774948120117_processed.csv
2025-04-25 16:16:20,535 - src.etl.processing.data_processor - INFO - Procesamiento completado: 5/5 archivos procesados correctamente
2025-04-25 16:16:20,537 - __main__ - INFO - Procesamiento completado: 5/5 archivos procesados
2025-04-25 16:16:20,537 - __main__ - INFO - Iniciando fase de CARGA EN BASE DE DATOS
2025-04-25 16:16:20,538 - src.etl.loading.db_loader - INFO - Inicializado cargador de base de datos: C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\database\stocks.db
2025-04-25 16:16:20,540 - src.etl.loading.db_loader - INFO - Encontrados 10 archivos procesados para cargar
2025-04-25 16:16:20,542 - src.etl.loading.db_loader - INFO - Base de datos inicializada correctamente
2025-04-25 16:16:20,584 - src.etl.loading.db_loader - ERROR - Error al cargar datos para 1 en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:16:20,601 - src.etl.loading.db_loader - ERROR - Error al cargar datos para 20 en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:16:20,669 - src.etl.loading.db_loader - ERROR - Error al cargar datos para 21 en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:16:20,731 - src.etl.loading.db_loader - ERROR - Error al cargar datos para 2 en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:16:20,748 - src.etl.loading.db_loader - ERROR - Error al cargar datos para 2 en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:16:20,775 - src.etl.loading.db_loader - ERROR - Error al cargar datos para 2 en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:16:20,815 - src.etl.loading.db_loader - ERROR - Error al cargar datos para 2 en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:16:20,827 - src.etl.loading.db_loader - ERROR - Error al cargar datos para 2 en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:16:20,895 - src.etl.loading.db_loader - ERROR - Error al cargar datos para 7 en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:16:20,908 - src.etl.loading.db_loader - ERROR - Error al cargar datos para 7 en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:16:20,908 - src.etl.loading.db_loader - INFO - Carga en base de datos completada: 0/10 archivos cargados correctamente
2025-04-25 16:16:20,909 - __main__ - INFO - Carga en base de datos completada: 0/10 archivos cargados
2025-04-25 16:16:20,909 - __main__ - INFO - ETL completo finalizado con éxito
