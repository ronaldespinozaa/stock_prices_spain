2025-04-25 16:56:38,571 - __main__ - INFO - Iniciando ETL completo (20250425_165638)
2025-04-25 16:56:38,571 - __main__ - INFO - Iniciando fase de EXTRACCIÓN
2025-04-25 16:56:38,572 - __main__ - INFO - Procesando 10 símbolos: ['SAN.MC', 'BBVA.MC', 'IBE.MC', 'ITX.MC', 'TEF.MC', 'REP.MC', 'CABK.MC', 'NTGY.MC', 'FER.MC', 'AMS.MC']
2025-04-25 16:56:38,572 - src.etl.extraction.historical_extraction - INFO - Inicializado extractor para 10 tickers, max_workers=2, period=5y
2025-04-25 16:56:38,573 - src.etl.extraction.historical_extraction - INFO - Procesando 10 en lotes de 3
2025-04-25 16:56:38,574 - src.etl.extraction.historical_extraction - INFO - Procesando lote 1: ['SAN.MC', 'BBVA.MC', 'IBE.MC']
2025-04-25 16:56:38,575 - src.utils.stock_utils - INFO - Descargando datos para SAN.MC con período 5y e intervalo 1d
2025-04-25 16:56:38,575 - src.utils.stock_utils - INFO - Descargando datos para BBVA.MC con período 5y e intervalo 1d
2025-04-25 16:56:40,116 - src.utils.stock_utils - INFO - Descargados 1281 registros para BBVA.MC
2025-04-25 16:56:40,122 - src.utils.stock_utils - INFO - Descargados 1281 registros para SAN.MC
2025-04-25 16:56:40,123 - src.utils.stock_utils - INFO - Guardando datos de BBVA.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\BBVA_MC_historical.csv
2025-04-25 16:56:40,143 - src.utils.stock_utils - INFO - Guardando datos de SAN.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\SAN_MC_historical.csv
2025-04-25 16:56:40,235 - src.utils.stock_utils - INFO - Descargando datos para IBE.MC con período 5y e intervalo 1d
2025-04-25 16:56:41,281 - src.utils.stock_utils - INFO - Descargados 1281 registros para IBE.MC
2025-04-25 16:56:41,281 - src.utils.stock_utils - INFO - Guardando datos de IBE.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\IBE_MC_historical.csv
2025-04-25 16:56:41,319 - src.etl.extraction.historical_extraction - INFO - Esperando 15 segundos antes del siguiente lote...
2025-04-25 16:56:56,320 - src.etl.extraction.historical_extraction - INFO - Procesando lote 2: ['ITX.MC', 'TEF.MC', 'REP.MC']
2025-04-25 16:56:56,321 - src.utils.stock_utils - INFO - Descargando datos para ITX.MC con período 5y e intervalo 1d
2025-04-25 16:56:56,322 - src.utils.stock_utils - INFO - Descargando datos para TEF.MC con período 5y e intervalo 1d
2025-04-25 16:56:57,169 - src.utils.stock_utils - INFO - Descargados 1281 registros para ITX.MC
2025-04-25 16:56:57,170 - src.utils.stock_utils - INFO - Guardando datos de ITX.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\ITX_MC_historical.csv
2025-04-25 16:56:57,212 - src.utils.stock_utils - INFO - Descargando datos para REP.MC con período 5y e intervalo 1d
2025-04-25 16:56:57,450 - src.utils.stock_utils - INFO - Descargados 1281 registros para TEF.MC
2025-04-25 16:56:57,452 - src.utils.stock_utils - INFO - Guardando datos de TEF.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\TEF_MC_historical.csv
2025-04-25 16:56:58,280 - src.utils.stock_utils - INFO - Descargados 1281 registros para REP.MC
2025-04-25 16:56:58,281 - src.utils.stock_utils - INFO - Guardando datos de REP.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\REP_MC_historical.csv
2025-04-25 16:56:58,337 - src.etl.extraction.historical_extraction - INFO - Esperando 15 segundos antes del siguiente lote...
2025-04-25 16:57:13,339 - src.etl.extraction.historical_extraction - INFO - Procesando lote 3: ['CABK.MC', 'NTGY.MC', 'FER.MC']
2025-04-25 16:57:13,340 - src.utils.stock_utils - INFO - Descargando datos para CABK.MC con período 5y e intervalo 1d
2025-04-25 16:57:13,340 - src.utils.stock_utils - INFO - Descargando datos para NTGY.MC con período 5y e intervalo 1d
2025-04-25 16:57:15,494 - src.utils.stock_utils - INFO - Descargados 1281 registros para CABK.MC
2025-04-25 16:57:15,496 - src.utils.stock_utils - INFO - Guardando datos de CABK.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\CABK_MC_historical.csv
2025-04-25 16:57:15,499 - src.utils.stock_utils - INFO - Descargados 1281 registros para NTGY.MC
2025-04-25 16:57:15,517 - src.utils.stock_utils - INFO - Guardando datos de NTGY.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\NTGY_MC_historical.csv
2025-04-25 16:57:15,573 - src.utils.stock_utils - INFO - Descargando datos para FER.MC con período 5y e intervalo 1d
2025-04-25 16:57:16,322 - src.utils.stock_utils - INFO - Descargados 1281 registros para FER.MC
2025-04-25 16:57:16,323 - src.utils.stock_utils - INFO - Guardando datos de FER.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\FER_MC_historical.csv
2025-04-25 16:57:16,374 - src.etl.extraction.historical_extraction - INFO - Esperando 15 segundos antes del siguiente lote...
2025-04-25 16:57:31,375 - src.etl.extraction.historical_extraction - INFO - Procesando lote 4: ['AMS.MC']
2025-04-25 16:57:31,376 - src.utils.stock_utils - INFO - Descargando datos para AMS.MC con período 5y e intervalo 1d
2025-04-25 16:57:33,744 - src.utils.stock_utils - INFO - Descargados 1281 registros para AMS.MC
2025-04-25 16:57:33,745 - src.utils.stock_utils - INFO - Guardando datos de AMS.MC en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw\AMS_MC_historical.csv
2025-04-25 16:57:33,814 - src.etl.extraction.historical_extraction - INFO - Procesamiento completado: 10/10 símbolos extraídos correctamente
2025-04-25 16:57:33,820 - src.etl.extraction.historical_extraction - INFO - Informe de extracción guardado en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\reports\extraction_report_20250425_165733.csv
2025-04-25 16:57:33,821 - __main__ - INFO - Extracción completada: 10/10 símbolos procesados correctamente
2025-04-25 16:57:33,822 - __main__ - INFO - Informe guardado en: C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\reports\extraction_report_20250425_165733.csv
2025-04-25 16:57:33,822 - __main__ - INFO - Iniciando fase de PROCESAMIENTO
2025-04-25 16:57:33,823 - src.etl.processing.data_processor - INFO - Inicializado procesador de datos con directorio raw: C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\raw
2025-04-25 16:57:33,824 - src.etl.processing.data_processor - INFO - Encontrados 10 archivos para procesar
2025-04-25 16:57:33,840 - src.etl.processing.data_processor - INFO - Datos procesados para AMS: 1281 registros
2025-04-25 16:57:33,882 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\AMS_processed.csv
2025-04-25 16:57:33,899 - src.etl.processing.data_processor - INFO - Datos procesados para BBVA: 1281 registros
2025-04-25 16:57:33,947 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\BBVA_processed.csv
2025-04-25 16:57:33,956 - src.etl.processing.data_processor - INFO - Datos procesados para CABK: 1281 registros
2025-04-25 16:57:34,013 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\CABK_processed.csv
2025-04-25 16:57:34,022 - src.etl.processing.data_processor - INFO - Datos procesados para FER: 1281 registros
2025-04-25 16:57:34,054 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\FER_processed.csv
2025-04-25 16:57:34,063 - src.etl.processing.data_processor - INFO - Datos procesados para IBE: 1281 registros
2025-04-25 16:57:34,096 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\IBE_processed.csv
2025-04-25 16:57:34,111 - src.etl.processing.data_processor - INFO - Datos procesados para ITX: 1281 registros
2025-04-25 16:57:34,148 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\ITX_processed.csv
2025-04-25 16:57:34,158 - src.etl.processing.data_processor - INFO - Datos procesados para NTGY: 1281 registros
2025-04-25 16:57:34,194 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\NTGY_processed.csv
2025-04-25 16:57:34,204 - src.etl.processing.data_processor - INFO - Datos procesados para REP: 1281 registros
2025-04-25 16:57:34,257 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\REP_processed.csv
2025-04-25 16:57:34,273 - src.etl.processing.data_processor - INFO - Datos procesados para SAN: 1281 registros
2025-04-25 16:57:34,307 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\SAN_processed.csv
2025-04-25 16:57:34,331 - src.etl.processing.data_processor - INFO - Datos procesados para TEF: 1281 registros
2025-04-25 16:57:34,363 - src.etl.processing.data_processor - INFO - Datos procesados guardados en C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\processed\TEF_processed.csv
2025-04-25 16:57:34,364 - src.etl.processing.data_processor - INFO - Procesamiento completado: 10/10 archivos procesados correctamente
2025-04-25 16:57:34,364 - __main__ - INFO - Procesamiento completado: 10/10 archivos procesados
2025-04-25 16:57:34,365 - __main__ - INFO - Iniciando fase de CARGA EN BASE DE DATOS
2025-04-25 16:57:34,368 - src.etl.loading.db_loader - INFO - Inicializado cargador de base de datos: C:\Users\ronal\Documentos\proyectos_github\etl_precio_acciones_airflow\data\database\stocks.db
2025-04-25 16:57:34,371 - src.etl.loading.db_loader - INFO - Encontrados 10 archivos procesados para cargar
2025-04-25 16:57:34,373 - src.etl.loading.db_loader - INFO - Base de datos inicializada correctamente
2025-04-25 16:57:34,431 - src.etl.loading.db_loader - ERROR - Error al cargar datos para AMS en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:57:34,468 - src.etl.loading.db_loader - ERROR - Error al cargar datos para BBVA en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:57:34,523 - src.etl.loading.db_loader - ERROR - Error al cargar datos para CABK en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:57:34,570 - src.etl.loading.db_loader - ERROR - Error al cargar datos para FER en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:57:34,614 - src.etl.loading.db_loader - ERROR - Error al cargar datos para IBE en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:57:34,655 - src.etl.loading.db_loader - ERROR - Error al cargar datos para ITX en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:57:34,700 - src.etl.loading.db_loader - ERROR - Error al cargar datos para NTGY en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:57:34,744 - src.etl.loading.db_loader - ERROR - Error al cargar datos para REP en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:57:34,791 - src.etl.loading.db_loader - ERROR - Error al cargar datos para SAN en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:57:34,846 - src.etl.loading.db_loader - ERROR - Error al cargar datos para TEF en la base de datos: NOT NULL constraint failed: stocks.ticker
2025-04-25 16:57:34,847 - src.etl.loading.db_loader - INFO - Carga en base de datos completada: 0/10 archivos cargados correctamente
2025-04-25 16:57:34,849 - __main__ - INFO - Carga en base de datos completada: 0/10 archivos cargados
2025-04-25 16:57:34,849 - __main__ - INFO - ETL completo finalizado con éxito
